<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="心脏高精度动力学分析系统" />
    <meta name="author" content="" />
    <title>心脏高精度电动力学分析系统</title>
    <link rel="stylesheet" href="/assets/css/fonts/linecons/css/linecons.css">
    <link rel="stylesheet" href="/assets/css/fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/assets/css/bootstrap-treeview.css">
    <link rel="stylesheet" href="/assets/css/bootstrap.css">
    <link rel="stylesheet" href="/assets/css/xenon-core.css">
    <link rel="stylesheet" href="/assets/css/xenon-forms.css">
    <link rel="stylesheet" href="/assets/css/xenon-components.css">
    <link rel="stylesheet" href="/assets/css/xenon-skins.css">
    <link rel="stylesheet" href="/assets/css/systemManage.css">
    <script src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/Scripts/StationJSLib.js"></script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="/Scripts/common/zoolina.page.whu.plug.js"></script>
</head>
<body class="page-body">
<div class="page-container">
    <div class="sidebar-menu toggle-others fixed">
        <div class="sidebar-menu-inner" id="sidebar-menu-inner">
        </div>
    </div>
    <div class="main-content">
        <!-- User Info, Notifications and Menu Bar -->
        <!--相应的顶部导航区相应的内容-->
        <div id="nav-content-inner">
        </div>
        <div class="page-title">
            <div class="title-env">
                <h1 class="title">人员管理</h1>
                <p class="description">People List Manage</p>
            </div>
            <div class="breadcrumb-env">
                <ol class="breadcrumb bc-1">
                    <li>
                        <a href="main.html"><i class="fa-home"></i>Home</a>
                    </li>
                    <li>
                        <a href="systemManage.html">Person Manage</a>
                    </li>
                    <li class="active">
                        <strong>People List Manage</strong>
                    </li>
                </ol>
            </div>
        </div>
        <script type="text/javascript">
          jQuery(document).ready(function($) {
            $("#s2example-1").select2
            ({
              placeholder: '11',
            }).on('select2-open', function () {
              $(this).data('select2').results.addClass('overflow-hidden').perfectScrollbar();
            });
            $("#sex").selectBoxIt().on('open', function () {
              $(this).data('selectBoxSelectBoxIt').list.perfectScrollbar();
            });
            var obj_name = new Array();
            var process_name = function () {
              curDepartName = obj_name[0];
            }
            //生成部门树
            var defaultData;
            var obj_tree = new Array();
            var processResult_tree = function () {
              //替换字符串内容，形成json数组
              var nid = -1;
              //分组模块
              loadFromWS("Home/person/loadPersons.template", "id="+nid+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
              var jd = obj_tree[0].replace(/\'/g, '\"');
              var jsonData = jd.replace(/&/g, '\'');
              jsonData = jsonData.substr(0, jsonData.length - 1);
              var str = '[' + jsonData + ']';
              var zNodes = JSON.parse(str);
              var newTree = new Array();
              var toDelete = new Array();
              for (var i = 0; i < zNodes.length; i++)
              {
                var json = {};
                json['text'] = zNodes[i].text;
                json['id'] = zNodes[i].id;
                json['type'] = zNodes[i].type;
                json['nodes'] = new Array;
                newTree.push(json);
              }
              var administratorJson = {};
              administratorJson['text'] = "管理员"
              administratorJson['id'] = -1;
              administratorJson['nodes'] = new Array;
              var userJson = {};
              userJson['text'] = "用户"
              userJson['id'] = -2;
              userJson['nodes'] = new Array;
              for (var i = 0; i < newTree.length; i++) {
                if (newTree[i].type == "user") {
                  userJson.nodes.push(newTree[i]);
                }
                if (newTree[i].type == "administrator") {
                  administratorJson.nodes.push(newTree[i]);
                }
              }
              var defaultArray = new Array;
              defaultArray.push(administratorJson);
              defaultArray.push(userJson);
              var defaultData = JSON.stringify(defaultArray);
              //var defaultData = JSON.stringify(newTree);
              $('#treeview-selectable').treeview({
                data: defaultData,
                backColor: '#fff',
                borderColor: '#eeeeee',
                nodeIcon: 'glyphicon glyphicon-indent-left',
                selectedBackColor: '#efebeb',
                selectedColor: '#8f1fdc',
                showIcon: true,
                showTags: false,
                onNodeSelected: function (event, node) {
                  console.log(node.id);
                  loadFromWS("Home/person/loadPersons.template", "id="+node.id+"$^@^$loginName="+sessionStorage.getItem("loginName"), "wholetable");
                },
                onNodeUnselected: function (event, node) {
                }
              });
            }
            getFromWS("Home/person/OrganizationSys.template", "loginName="+sessionStorage.getItem("loginName"), obj_tree, processResult_tree);
          });

        </script>
        <div class="panel panel-default">
            <div class="panel-heading"></div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-3">
                        <h4 class="school">人员分组</h4>
                        <div id="treeview-selectable" class=""></div>
                    </div>
                    <script type="text/javascript">
                      function isNull(str) {
                        /*
                        var pat = /\s+/;：有空格就不行
                        str.match(/^\s+$/) ：全空格才不行
                        */
                        if (str == "" || str.match(/^\s+$/))
                          return true;
                        else
                          return false;
                      }

                      var opts = {
                        "closeButton": true,
                        "debug": false,
                        "positionClass": "toast-bottom-right",
                        "onclick": null,
                        "showDuration": "300",
                        "hideDuration": "1000",
                        "timeOut": "5000",
                        "extendedTimeOut": "1000",
                        "showEasing": "swing",
                        "hideEasing": "linear",
                        "showMethod": "fadeIn",
                        "hideMethod": "fadeOut"
                      };

                      //添加管理员
                      function addmember() {
                        $ (":file").val ("");
                        var objNI = new Array();
                        var newid;
                        var processResultNI = function ()
                        {
                          newid = objNI[0];
                          $("#addid").val(newid);
                        }
                        $("#addlogin").val("");
                        $("#addname").val("");
                        $("#addpasswd").val("");
                        $("#addpasswdsure").val("");
                        getFromWS("Home/person/getNewId.template", "", objNI, processResultNI);

                        var objCurnum = new Array();
                        var curNum;
                        var processResultCur = function ()
                        {
                          if(objCurnum[0] == "__null__"){
                            curNum = 1;
                            $("#addnumber").val(curNum);
                          }else{
                            curNum = Number(objCurnum[0])+1;
                            $("#addnumber").val(curNum);
                          }
                        }
                        getFromWS("Home/person/getCurMaxNum.template", "classification=" + 1, objCurnum, processResultCur);
                        $('#addmodal').modal('show');
                      }
                      //添加医生
                      function adddoctor() {
                        $ (":file").val ("");
                        var objNI = new Array();
                        var newid;
                        var processResultNI = function ()
                        {
                          newid = objNI[0];
                          $("#adddocid").val(newid);
                        }
                        getFromWS("Home/person/getNewId.template", "", objNI, processResultNI);
                        $("#adddoclogin").val("");
                        $("#adddocname").val("");
                        $("#addhospital").val("");
                        $("#adddepart").val("");
                        $("#addposition ").val("");
                        $("#addpasswd").val("");
                        $("#addpasswdsure").val("");
                        $("#adddocphone").val("");
                        $("#addtoken").val("");

                        var objCurnum = new Array();
                        var curNum;
                        var processResultCur = function ()
                        {
                          if(objCurnum[0] == "__null__"){
                            curNum = 1;
                            $("#adddocnumber").val(curNum);
                          }else{
                            curNum = Number(objCurnum[0])+1;
                            $("#adddocnumber").val(curNum);
                          }
                        }
                        getFromWS("Home/person/getCurMaxNum.template", "classification=" + 2, objCurnum, processResultCur);
                        $('#adddoctormodal').modal('show');
                      }
                      //添加用户
                      function addclient() {
                        $ (":file").val ("");
                        var objNI = new Array();
                        var newid;
                        var processResultNI = function ()
                        {
                          newid = objNI[0];
                          $("#addclientid").val(newid);
                        }
                        $("#addclientlogin").val("");
                        $("#addclientname").val("");
                        $("#addclientphone").val("");
                        $("#addclientpasswd").val("");
                        $("#addclientpasswdsure ").val("");
                        getFromWS("Home/person/getNewId.template", "", objNI, processResultNI);

                        var objCurnum = new Array();
                        var curNum;
                        var processResultCur = function ()
                        {
                          if(objCurnum[0] == "__null__"){
                            curNum = 1;
                            $("#addclientnumber").val(curNum);
                          }else{
                            curNum = Number(objCurnum[0])+1;
                            $("#addclientnumber").val(curNum);
                          }
                        }
                        getFromWS("Home/person/getCurMaxNum.template", "classification=" + 3, objCurnum, processResultCur);
                        $('#addclientmodal').modal('show');
                      }

                      function deletePatch() {
                        loadFromWS("Home/person/loadAllAdministrator.template", "", "deladministrator_body");
                        loadFromWS("Home/person/doctor/loadAllDoctors.template", "", "deldoctor_body");
                        loadFromWS("Home/person/client/loadAllClients.template", "", "delclient_body");
                        $('#deletepatchmodal').modal('show');
                      }
                      //修改人员信息
                      function editmember(id) {
                        var obj = new Array();
                        var processResult = function () {
                          var str = obj[0].replace(/\'/g, '\"');
                          var person = JSON.parse(str);
                          if(person.classification == 2){
                            $("#editdoctorid").val(person.id);
                            sessionStorage.setItem('doctorLoginName',person.login_name);
                            $("#editdoctorlogin").val(person.login_name);
                            $("#editdoctorname").val(person.name);

                            $ (":file").val ("");
                            $("#editdoctorhospital").val(person.hospital);
                            $("#editdoctordepart").val(person.department);
                            $("#editdoctorposition").val(person.position);
                            $("#editdoctortoken").val(person.token);
                            $("#editdoctorphone").val(person.phone);
                            $('#editModalDoctor').modal('show');
                          }else if(person.classification == 3){
                            $("#editclientid").val(person.id);
                            $("#editclientlogin").val(person.login_name);
                            $("#editclientname").val(person.name);
                            $ (":file").val ("");
                            $("#editclientphone").val(person.phone);
                            $('#editModalClient').modal('show');
                          }else{
                            $("#editid").val(person.id);
                            $("#editname").val(person.name);
                            $("#editlogin").val(person.login_name);
                            $ (":file").val ("");
                            $('#editModal').modal('show');
                          }
                        }
                        getFromWS("Home/person/detailUser.template", "id=" + id, obj, processResult);
                      }
                      //显示人员信息
                      function detailmember(id) {
                        var obj = new Array();
                        var processResult = function () {
                          var str = obj[0].replace(/\'/g, '\"');
                          var person = JSON.parse(str);
                          if(person.classification == 2){
                            $("#detaildoctorid").val(person.id);
                            $("#detaildoctorlogin").val(person.login_name);
                            $("#detaildoctorname").val(person.name);
                            $("#detaildoctorclassification").val(person.classname);
                            $("#detaildoctorhospital").val(person.hospital);
                            $("#detaildoctordepart").val(person.department);
                            $("#detaildoctorposition").val(person.position);
                            $("#detaildoctortoken").val(person.token);
                            $("#detaildoctorphone").val(person.phone);
                            $('#previewdoctor').modal('show');
                          }else if(person.classification == 3){
                            $("#detailclientid").val(person.id);
                            $("#detailclientlogin").val(person.login_name);
                            $("#detailclientname").val(person.name);
                            // $("#detailphoto").val(person.photo);
                            // document.getElementById("avatar").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+person.photo;
                            $("#detailclientclassification").val(person.classname);
                            $("#detailclientphone").val(person.phone);
                            $('#previewclient').modal('show');
                          }else{
                            photo = person.photo;
                            $("#detailid").val(person.id);
                            $("#detaillogin").val(person.login_name);
                            $("#detailname").val(person.name);
                            // $("#detailphoto").val(person.photo);
                            // document.getElementById("avatar").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+person.photo;
                            $("#detailclassification").val(person.classname);
                            $('#preview').modal('show');
                          }
                        }
                        console.log(obj);
                        getFromWS("Home/person/detailUser.template", "id=" + id, obj, processResult);
                      }
                      //删除人员
                      function delmember(id) {
                        $('#deleteModal').modal('show');

                        var obj = new Array();
                        var processResult = function () {
                          var str = obj[0].replace(/\'/g, '\"');
                          var person = JSON.parse(str);
                          $("#deletesid").val(person.id);
                          $("#deleteclassification").val(person.classification);
                        }
                        getFromWS("Home/person/detailUser.template", "id=" + id, obj, processResult);

                      }

                    </script>
                    <div class="col-sm-9" id="wholetable">
                    </div>
                </div>
            </div>
        </div>
        <footer class="main-footer sticky footer-type-1">
            <div class="footer-inner">
                <div class="footer-text">
                    &copy; 2018
                    <strong>heart</strong>
                    </a> 心脏高精度电动力学分析系统 - Collect from <a href="http://sdev.whu.edu.cn/" title="网页模板" target="_blank">武汉大学</a>
                </div>
                <div class="go-up">
                    <a href="#" rel="go-top">
                        <i class="fa-angle-up"></i>
                    </a>
                </div>
            </div>
        </footer>
    </div>
</div>
<div class="modal fade" id="deleteModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header noborder">
                <h4 class="modal-title">确定删除此用户？</h4>
            </div>
            <div class="form-group" style="display: none;">
                <input type="text" class="form-control" name='delsid' id="deletesid" required>
                <input type="text" class="form-control" name='delclassification' id="deleteclassification" required>
            </div>
            <div class="modal-footer noborder">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" style="margin-left:40px" id="removeItem">确定</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="addmodal" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">新增管理员</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label id="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='phone' id="addid" disabled>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label  class="control-label">序号</label>
                            <input type="text" class="form-control" name='phone' id="addnumber" disabled>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' id="addlogin" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="addname" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">密码</label>
                            <input type="password" class="form-control" name='name' id="addpasswd" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">确认密码</label>
                            <input type="password" class="form-control" name='name' id="addpasswdsure" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!--<div class="col-md-6">-->
                    <!--<div class="form-group">-->
                    <!--<label for="field-5" class="control-label">头像</label>-->
                    <!--<img src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid=2018181828600001001" style="width:200px;height:200px;margin-left: 20px" id="addphoto">-->
                    <!--<input type="file" id="add_photo" style="margin-left: 100px;margin-top: 10px" onchange="addNewPhoto()">-->
                    <!--<script type="text/javascript">-->
                    <!--var addphotoId;-->
                    <!--function addNewPhoto() {-->
                    <!--var userName = localStorage.getItem("loginName");-->
                    <!--var file = $("#addNewPhoto").val();-->
                    <!--var afterUploadFile = function(tid){//uploadToDatabase执行成功后返回的图片的id-->
                    <!--document.getElementById("addphoto").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+tid;-->
                    <!--addphotoId = tid;-->
                    <!--var paras = "picId=" + tid;-->
                    <!--var objs = new Array();-->
                    <!--var afterSavePic = function () {-->
                    <!--if (objs[0] == "ok") {-->
                    <!--location.reload(true);-->
                    <!--} else {-->
                    <!--alert("选择头像失败");-->
                    <!--}-->
                    <!--};-->
                    <!--}-->

                    <!--uploadToDatabase("add_photo ",afterUploadFile,"databaseType=PostgresXL")-->

                    <!--}-->
                    <!--</script>-->
                    <!--</div>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="addsave">确定</button>
            </div>
        </div>
    </div>
</div><!--add-->

<div class="modal fade" id="adddoctormodal" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">新增医生</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label id="field-6" class="control-label">编号</label>
                            <input type="text" class="form-control" name='phone' id="adddocid" disabled>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label  class="control-label">序号</label>
                            <input type="text" class="form-control" name='phone' id="adddocnumber" disabled>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' id="adddoclogin" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="adddocname" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label id="field-8" class="control-label">医院</label>
                            <input type="text" class="form-control" name='phone' id="addhospital" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">科室</label>
                            <input type="text" class="form-control" name='name' id="adddepart" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="control-label">职位</label>
                            <input type="text" class="form-control" name='phone' id="addposition" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">邀请码</label>
                            <input type="text" class="form-control" name='name' id="addtoken" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name' id="adddocphone" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="field-5" class="control-label" style="color: black">验证码</label>
                            <input type="text" class="form-control" name='name' id="adddocVerificationCode" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="field-5" style="color: white" class="control-label">sendVerificationCode</label>
                            <button style="background-color: #0b6aff;color: white;" type="button" class="form-control" id="senddocVerificationCode">获取验证码</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">密码</label>
                            <input type="password" class="form-control" name='name' id="adddocpasswd" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">确认密码</label>
                            <input type="password" class="form-control" name='name' id="adddocpasswdsure" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!--<div class="col-md-6">-->
                    <!--<div class="form-group">-->
                    <!--<label for="field-5" class="control-label">头像</label>-->
                    <!--<img src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid=2018181828600001001" style="width:200px;height:200px;margin-left: 20px" id="addphoto">-->
                    <!--<input type="file" id="add_photo" style="margin-left: 100px;margin-top: 10px" onchange="addNewPhoto()">-->
                    <!--<script type="text/javascript">-->
                    <!--var addphotoId;-->
                    <!--function addNewPhoto() {-->
                    <!--var userName = localStorage.getItem("loginName");-->
                    <!--var file = $("#addNewPhoto").val();-->
                    <!--var afterUploadFile = function(tid){//uploadToDatabase执行成功后返回的图片的id-->
                    <!--document.getElementById("addphoto").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+tid;-->
                    <!--addphotoId = tid;-->
                    <!--var paras = "picId=" + tid;-->
                    <!--var objs = new Array();-->
                    <!--var afterSavePic = function () {-->
                    <!--if (objs[0] == "ok") {-->
                    <!--location.reload(true);-->
                    <!--} else {-->
                    <!--alert("选择头像失败");-->
                    <!--}-->
                    <!--};-->
                    <!--}-->

                    <!--uploadToDatabase("add_photo ",afterUploadFile,"databaseType=PostgresXL")-->

                    <!--}-->
                    <!--</script>-->
                    <!--</div>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="adddocsave">确定</button>
            </div>
        </div>
    </div>
</div><!--add-->

<div class="modal fade" id="addclientmodal" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">新增客户</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label id="field-7" class="control-label">编号</label>
                            <input type="text" class="form-control" name='phone' id="addclientid" disabled>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label  class="control-label">序号</label>
                            <input type="text" class="form-control" name='phone' id="addclientnumber" disabled>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' id="addclientlogin" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="addclientname" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name' id="addclientphone" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="field-5" class="control-label" style="color: black">验证码</label>
                            <input type="text" class="form-control" name='name' id="addClientVerificationCode" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="field-5" style="color: white" class="control-label">sendVerificationCode</label>
                            <button style="background-color: #0b6aff;color: white;" type="button" class="form-control" id="sendClientVerificationCode">获取验证码</button>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">密码</label>
                            <input type="password" class="form-control" name='name' id="addclientpasswd" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">确认密码</label>
                            <input type="password" class="form-control" name='name' id="addclientpasswdsure" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <!--<div class="col-md-6">-->
                    <!--<div class="form-group">-->
                    <!--<label for="field-5" class="control-label">头像</label>-->
                    <!--<img src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid=2018181828600001001" style="width:200px;height:200px;margin-left: 20px" id="addphoto">-->
                    <!--<input type="file" id="add_photo" style="margin-left: 100px;margin-top: 10px" onchange="addNewPhoto()">-->
                    <!--<script type="text/javascript">-->
                    <!--var addphotoId;-->
                    <!--function addNewPhoto() {-->
                    <!--var userName = localStorage.getItem("loginName");-->
                    <!--var file = $("#addNewPhoto").val();-->
                    <!--var afterUploadFile = function(tid){//uploadToDatabase执行成功后返回的图片的id-->
                    <!--document.getElementById("addphoto").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+tid;-->
                    <!--addphotoId = tid;-->
                    <!--var paras = "picId=" + tid;-->
                    <!--var objs = new Array();-->
                    <!--var afterSavePic = function () {-->
                    <!--if (objs[0] == "ok") {-->
                    <!--location.reload(true);-->
                    <!--} else {-->
                    <!--alert("选择头像失败");-->
                    <!--}-->
                    <!--};-->
                    <!--}-->

                    <!--uploadToDatabase("add_photo ",afterUploadFile,"databaseType=PostgresXL")-->

                    <!--}-->
                    <!--</script>-->
                    <!--</div>-->
                    <!--</div>-->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="addclientsave">确定</button>
            </div>
        </div>
    </div>
</div><!--add-->

<div class="modal fade" id="deletepatchmodal" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">批量删除</h4>
            </div>
            <ul class="nav nav-pills">
                <li id="li_deladministrator"><a href="#">批量删除管理员</a></li>
                <li id="li_deldoctor"><a href="#">批量删除医生</a></li>
                <li id="li_delclient"><a href="#">批量删除客户</a></li>
            </ul>
            <script type="text/javascript">
              //获取所有li的节点
              var list_ad =  document.getElementById("li_deladministrator");
              //给每个li绑定事件
              list_ad.onclick = function(){
                document.getElementById("deladministrator_div").style.display="";
                document.getElementById("deldoctor_div").style.display="none";
                document.getElementById("delclient_div").style.display="none";
              }
              var list_doc =  document.getElementById("li_deldoctor");
              //给每个li绑定事件
              list_doc.onclick = function(){
                document.getElementById("deladministrator_div").style.display="none";
                document.getElementById("deldoctor_div").style.display="";
                document.getElementById("delclient_div").style.display="none";
              }
              var list_client =  document.getElementById("li_delclient");
              //给每个li绑定事件
              list_client.onclick = function(){
                document.getElementById("deladministrator_div").style.display="none";
                document.getElementById("deldoctor_div").style.display="none";
                document.getElementById("delclient_div").style.display="";
              }
            </script>
            <div id="deladministrator_div">
                <div id="deladministrator_body" class="modal-body">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-info" id="deleteadminsave">确定</button>
                </div>
            </div>
            <div id="deldoctor_div" style="display:none">
                <div id="deldoctor_body" class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-info" id="deletedocsave">确定</button>
                </div>
            </div>

            <div id="delclient_div" style="display:none">
                <div id="delclient_body" class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-info" id="deleteclientsave">确定</button>
                </div>
            </div>

        </div>
    </div>
</div><!--add-->

<div class="modal fade" id="preview" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">查看用户</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="detailid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' disabled id="detaillogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' disabled id="detailname">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">级别</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclassification">
                        </div>
                    </div>
                </div>
                <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                <!--<label for="field-5" class="control-label">头像</label>-->
                <!--<img src="" style="width:200px;height:200px;margin-left: 20px" id="avatar">-->
                <!--</div>-->
                <!--</div>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</div><!--preview-->

<div class="modal fade" id="previewdoctor" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">查看医生</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorlogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorname">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">级别</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorclassification">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">医院</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorhospital">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">科室</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctordepart">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">职位</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctorposition">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">邀请码</label>
                            <input type="text" class="form-control" name='name' disabled id="detaildoctortoken">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name' disabled  id="detaildoctorphone">
                        </div>
                    </div>
                </div>
                <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                <!--<label for="field-5" class="control-label">头像</label>-->
                <!--<img src="" style="width:200px;height:200px;margin-left: 20px" id="avatar">-->
                <!--</div>-->
                <!--</div>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</div><!--preview-->

<div class="modal fade" id="previewclient" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">查看客户</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclientid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclientlogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclientname">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">级别</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclientclassification">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name' disabled id="detailclientphone">
                        </div>
                    </div>
                </div>
                <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                <!--<div class="form-group">-->
                <!--<label for="field-5" class="control-label">头像</label>-->
                <!--<img src="" style="width:200px;height:200px;margin-left: 20px" id="avatar">-->
                <!--</div>-->
                <!--</div>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</div><!--preview-->

<div class="modal fade" id="editModal" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">修改用户信息</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="editid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name'  id="editlogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="editname">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="editsave">确定</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editModalDoctor" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">修改医生信息</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="editdoctorid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name'  id="editdoctorlogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="editdoctorname">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">医院</label>
                            <input type="text" class="form-control" name='name'  id="editdoctorhospital">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">科室</label>
                            <input type="text" class="form-control" name='name'  id="editdoctordepart">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">职位</label>
                            <input type="text" class="form-control" name='name'  id="editdoctorposition">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">邀请码</label>
                            <input type="text" class="form-control" name='name'  id="editdoctortoken">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name'  id="editdoctorphone">
                        </div>
                    </div>
                </div>
                <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                <!--<div class="form-group" id="headImage">-->
                <!--<label for="field-5" class="control-label">头像</label>-->
                <!--<img src="" style="width:200px;height:200px;margin-left: 20px" id="editavatar">-->
                <!--<input type="file" id="upload_file" style="margin-left: 100px;margin-top: 10px" onchange="uploadHeadImg()">-->
                <!--<script type="text/javascript">-->
                <!--var newAvatarId = 12345;-->
                <!--function uploadHeadImg() {-->
                <!--var userName = localStorage.getItem("loginName");-->
                <!--var file = $("#upload_file").val();-->
                <!--var afterUploadFile = function(tid){//uploadToDatabase执行成功后返回的图片的id-->
                <!--console.log(tid);-->
                <!--newAvatarId = tid;-->
                <!--console.log("newAvatarId"+newAvatarId);-->
                <!--document.getElementById("editavatar").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+tid;-->
                <!--var paras = "picId=" + tid;-->
                <!--paras += "$^@^$login_name=" + $("#editsid").val();-->
                <!--var objs = new Array();-->
                <!--var afterSavePic = function () {-->
                <!--if (objs[0] == "ok") {-->
                <!--} else {-->
                <!--alert("打开图片失败");-->
                <!--}-->
                <!--};-->
                <!--}-->

                <!--uploadToDatabase("upload_file",afterUploadFile,"databaseType=PostgresXL");-->

                <!--}-->
                <!--</script>-->
                <!--</div>-->
                <!--</div>-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="editdoctorsave">确定</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="editModalClient" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">修改客户信息</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">编号</label>
                            <input type="text" class="form-control" name='name' disabled id="editclientid">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">登录名</label>
                            <input type="text" class="form-control" name='name'  id="editclientlogin">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">姓名</label>
                            <input type="text" class="form-control" name='name' id="editclientname">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="field-5" class="control-label">手机号码</label>
                            <input type="text" class="form-control" name='name'  id="editclientphone">
                        </div>
                    </div>
                </div>
                <!--<div class="row">-->
                <!--<div class="col-md-6">-->
                <!--<div class="form-group" id="headImage">-->
                <!--<label for="field-5" class="control-label">头像</label>-->
                <!--<img src="" style="width:200px;height:200px;margin-left: 20px" id="editavatar">-->
                <!--<input type="file" id="upload_file" style="margin-left: 100px;margin-top: 10px" onchange="uploadHeadImg()">-->
                <!--<script type="text/javascript">-->
                <!--var newAvatarId = 12345;-->
                <!--function uploadHeadImg() {-->
                <!--var userName = localStorage.getItem("loginName");-->
                <!--var file = $("#upload_file").val();-->
                <!--var afterUploadFile = function(tid){//uploadToDatabase执行成功后返回的图片的id-->
                <!--console.log(tid);-->
                <!--newAvatarId = tid;-->
                <!--console.log("newAvatarId"+newAvatarId);-->
                <!--document.getElementById("editavatar").src="/one/downloadFile.spe?dtype=PostgresXL&mode=html&fileid="+tid;-->
                <!--var paras = "picId=" + tid;-->
                <!--paras += "$^@^$login_name=" + $("#editsid").val();-->
                <!--var objs = new Array();-->
                <!--var afterSavePic = function () {-->
                <!--if (objs[0] == "ok") {-->
                <!--} else {-->
                <!--alert("打开图片失败");-->
                <!--}-->
                <!--};-->
                <!--}-->

                <!--uploadToDatabase("upload_file",afterUploadFile,"databaseType=PostgresXL");-->

                <!--}-->
                <!--</script>-->
                <!--</div>-->
                <!--</div>-->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-info" id="editclientsave">确定</button>
            </div>
        </div>
    </div>
</div>

</div>
<link rel="stylesheet" href="/assets/js/uikit/uikit.css">
<link rel="stylesheet" href="/assets/js/datatables/dataTables.bootstrap.css">
<link rel="stylesheet" href="/assets/js/select2/select2.css">
<link rel="stylesheet" href="/assets/js/select2/select2-bootstrap.css">
<link rel="stylesheet" href="/assets/js/multiselect/css/multi-select.css">
<div class="bottom-script-inner" id="bottom-script-inner">
</div>
<script>
  jQuery(document).ready(function($) {
    var loadBottomScripts = function () {
      loadFromWS("Home/bottomscripts.template","sid="+sessionStorage.getItem('loginName')+"$^@^$session="+getAllSessionItems()+"$^@^$path="+window.location.pathname,"bottom-script-inner");
    };
    loadFromWS("Home/menu/LeftSideMenu.template", "Item=系统管理$^@^$item=人员管理$^@^$loginName="+sessionStorage.getItem('loginName'), "sidebar-menu-inner");
    //加载相应的公共页头
    loadFromWS("Home/menu/topNavContent.template", "userName=" + sessionStorage.getItem('userName'), "nav-content-inner");
  });
</script>
<script type="text/javascript">

  $('#editsave').on('click', function () {
    var id = $("#editid").val();
    var name = $("#editname").val();
    var login_name = $("#editlogin").val();

    if (isNull(login_name) || isNull(name) || isNull(id)) {
      toastr.error("个人资料填写不完整", "修改失败！", opts);
      return;
    }
    else {
      var obj_save = new Array();
      var processResult_save = function () {
        console.log("obj_save"+obj_save);
        if(obj_save[0]=="rpt")
        {
          toastr.error("修改登录名已存在", "修改管理员失败！", opts);
          return;
        }
        else{
          toastr.success("修改完成", "修改信息成功！", opts);
          $('#editModal').modal('hide');
          setTimeout(function()
          {
            loadFromWS("Home/person/loadPersons.template", "id=-1"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
          }, 1000);
        }
      }
      var postdata = "login_name=" + login_name + "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=" + 1;
      console.log("postdata"+postdata);
      getFromWS("Home/person/updatePerson.template", postdata, obj_save, processResult_save);
    }
  });

  $('#editdoctorsave').on('click', function () {
    var id = $("#editdoctorid").val();
    var name = $("#editdoctorname").val();
    var login_name = $("#editdoctorlogin").val();
    var hospital = $("#editdoctorhospital").val();
    var department = $("#editdoctordepart").val();
    var position = $("#editdoctorposition").val();
    var token = $("#editdoctortoken").val();
    var phone = $("#editdoctorphone").val();
    // var photo = newAvatarId;

    if (isNull(login_name) || isNull(name) || isNull(id)) {
      toastr.error("个人资料填写不完整", "修改失败！", opts);
      return;
    }
    else {
      var obj_save = new Array();
      console.log("obj_save"+obj_save);
      var processResult_save = function () {
        if(obj_save[0]=="rpt")
        {
          toastr.error("修改登录名已存在", "修改医生失败！", opts);
          return;
        }
        else{
          toastr.success("修改完成", "修改信息成功！", opts);
          $('#editModalDoctor').modal('hide');
          loadFromWS("Home/person/loadPersons.template", "id=2"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }
      }
      var postdata = "login_name=" + login_name + "$^@^$doctorLoginName="+ sessionStorage.getItem('doctorLoginName')+ "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=" + 2+"$^@^$hospital=" + hospital+"$^@^$department=" + department
          +"$^@^$position=" + position+"$^@^$token=" + token +"$^@^$phone=" + phone;
      console.log("postdata"+postdata);
      getFromWS("Home/person/updatePerson.template", postdata, obj_save, processResult_save);
    }
  });

  $('#editclientsave').on('click', function () {
    var id = $("#editclientid").val();
    var name = $("#editclientname").val();
    var login_name = $("#editclientlogin").val();
    var phone = $("#editclientphone").val();
    // var photo = newAvatarId;

    if (isNull(login_name) || isNull(name) || isNull(id)) {
      toastr.error("个人资料填写不完整", "修改失败！", opts);
      return;
    }
    else {
      var obj_save = new Array();
      console.log("obj_save"+obj_save);
      var processResult_save = function () {
        if(obj_save[0]=="rpt")
        {
          toastr.error("修改登录名已存在", "修改客户失败！", opts);
          return;
        }
        else{
          toastr.success("修改完成", "修改信息成功！", opts);
          $('#editModalClient').modal('hide');
          setTimeout(function()
          {
            loadFromWS("Home/person/loadPersons.template", "id=3"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
          }, 1000);
        }
      }
      var postdata = "login_name=" + login_name + "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=" + 3+"$^@^$phone=" + phone;
      console.log("postdata"+postdata);
      getFromWS("Home/person/updatePerson.template", postdata, obj_save, processResult_save);
    }
  });

  $('#addsave').on('click', function () {
    var id = $("#addid").val();
    var login_name = $("#addlogin").val();
    var name = $("#addname").val();
    var passwd = $("#addpasswd").val();
    var passwdsure = $("#addpasswdsure").val();
    var number = $("#addnumber").val();
    // var photo = addphotoId;
    //检查信息填写是否完整
    console.log(id+" "+login_name+" "+name+" ");
    if (isNull(login_name) || isNull(name)) {
      toastr.error("信息填写不完整", "添加管理员失败！", opts);
      return;
    }
    if (passwd != passwdsure) {
      toastr.error("两次输入密码不同", "添加管理员失败！", opts);
      return;
    }
    var obj = new Array();
    var processResult = function () {
      if(obj[0]=="rpt")
      {
        toastr.error("登录名重复", "添加管理员失败！", opts);
        return;
      }
      else
      {
        $('#addmodal').modal('hide');
        toastr.success("添加完成", "添加管理员成功！", opts);
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=-1"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
    }
    var postdata = "login_name=" + login_name + "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=" + 1 +
        "$^@^$passwd=" + passwd + "$^@^$number=" + number;
    getFromWS("Home/person/addPerson.template", postdata, obj, processResult);
  });

  $('#adddocsave').on('click', function () {
    var id = $("#adddocid").val();
    var login_name = $("#adddoclogin").val();
    var name = $("#adddocname").val();
    var hospital = $("#addhospital").val();
    var department = $("#adddepart").val();
    var position = $("#addposition").val();
    var token = $("#addtoken").val();
    var phone = $("#adddocphone").val();
    var passwd = $("#adddocpasswd").val();
    var passwdsure = $("#adddocpasswdsure").val();
    var number = $("#adddocnumber").val();
    // var photo = addphotoId;
    //检查信息填写是否完整
    console.log(id+" "+login_name+" "+name);
    if (passwd != passwdsure) {
      toastr.error("两次输入密码不同", "添加医生失败！", opts);
      return;
    }
    if (isNull(login_name) || isNull(name)) {
      toastr.error("信息填写不完整", "添加医生失败！", opts);
      return;
    }
    var obj = new Array();
    var processResult = function () {
      console.log(obj[0]);
      if(obj[0]=="rpt")
      {
        toastr.error("登录名重复", "添加医生失败！", opts);
        return;
      }
      else
      {
        $('#adddoctormodal').modal('hide');
        toastr.success("添加完成", "添加医生成功！", opts);
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=2"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
    }
    var postdata = "login_name=" + login_name + "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=2$^@^$hospital=" + hospital+"$^@^$department=" + department
        +"$^@^$position=" + position+"$^@^$token=" + token +"$^@^$phone=" + phone +"$^@^$passwd=" + passwd +"$^@^$number=" + number;
    getFromWS("Home/person/doctor/addDoctor.template", postdata, obj, processResult);
  });

  $('#addclientsave').on('click', function () {
    var id = $("#addclientid").val();
    var login_name = $("#addclientlogin").val();
    var name = $("#addclientname").val();
    var phone = $("#addclientphone").val();
    var passwd = $("#addclientpasswd").val();
    var passwdsure = $("#addclientpasswdsure").val();
    var number = $("#addclientnumber").val();
    // var photo = addphotoId;
    //检查信息填写是否完整
    console.log(id+" "+login_name+" "+name);
    if (passwd != passwdsure) {
      toastr.error("两次输入密码不同", "添加客户失败！", opts);
      return;
    }
    if (isNull(login_name) || isNull(name)) {
      toastr.error("信息填写不完整", "添加客户失败！", opts);
      return;
    }
    var obj = new Array();
    var processResult = function () {
      if(obj[0]=="rpt")
      {
        toastr.error("登录名重复", "添加客户失败！", opts);
        return;
      }
      else
      {
        $('#addclientmodal').modal('hide');
        toastr.success("添加完成", "添加客户成功！", opts);
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=3"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
    }
    var postdata = "login_name=" + login_name + "$^@^$name=" + name + "$^@^$id=" + id +"$^@^$classification=" + 3 +"$^@^$phone=" + phone+"$^@^$passwd=" + passwd + "$^@^$number=" + number;
    console.log(postdata);
    getFromWS("Home/person/client/addClient.template", postdata, obj, processResult);
  });

  $('#deleteadminsave').on('click', function () {
    var submitIds = "";
    var checkboxs = document.getElementsByName("isSubmitAdmin");
    for (var i = 0; i < checkboxs.length; i++) {
      if (checkboxs[i].checked){
        submitIds = submitIds + checkboxs[i].value + ",";
      }
    }
    submitIds = submitIds.substring(0, submitIds.length-1);
    console.log(submitIds);
    if (isNull(submitIds)) {
      toastr.error("所选编号不能为空", "删除失败！", opts);
      return;
    }
    else {
      var obj_del = new Array();
      var processResult_del = function () {
        toastr.success("批量删除完成", "删除成功！", opts);
        $('#deletepatchmodal').modal('hide');
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=-1"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
      var postdata = "submitIds=" + submitIds;
      getFromWS("Home/person/deleteAdmins.template", postdata, obj_del, processResult_del);
    }
  });

  $('#deletedocsave').on('click', function () {
    var submitIds = "";
    var checkboxs = document.getElementsByName("isSubmitDoctor");
    for (var i = 0; i < checkboxs.length; i++) {
      if (checkboxs[i].checked){
        submitIds = submitIds + checkboxs[i].value + ",";
      }
    }
    submitIds = submitIds.substring(0, submitIds.length-1);
    console.log(submitIds);
    if (isNull(submitIds)) {
      toastr.error("所选编号不能为空", "删除失败！", opts);
      return;
    }
    else {
      var obj_del = new Array();
      var processResult_del = function () {
        toastr.success("批量删除完成", "删除成功！", opts);
        $('#deletepatchmodal').modal('hide');
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=2"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
      var postdata = "submitIds=" + submitIds;
      getFromWS("Home/person/doctor/deleteDoctors.template", postdata, obj_del, processResult_del);
    }
  });

  $('#deleteclientsave').on('click', function () {
    var submitIds = "";
    var checkboxs = document.getElementsByName("isSubmitClient");
    for (var i = 0; i < checkboxs.length; i++) {
      if (checkboxs[i].checked){
        submitIds = submitIds + checkboxs[i].value + ",";
      }
    }
    submitIds = submitIds.substring(0, submitIds.length-1);
    console.log(submitIds);
    if (isNull(submitIds)) {
      toastr.error("所选编号不能为空", "删除失败！", opts);
      return;
    }
    else {
      var obj_del = new Array();
      var processResult_del = function () {
        toastr.success("批量删除完成", "删除成功！", opts);
        $('#deletepatchmodal').modal('hide');
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=3"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
      var postdata = "submitIds=" + submitIds;
      getFromWS("Home/person/client/deleteClients.template", postdata, obj_del, processResult_del);
    }
  });

  $('#removeItem').on('click', function () {
    var id = $("#deletesid").val();
    var classification = $("#deleteclassification").val();
    if (isNull(id)) {
      toastr.error("编号不能为空", "删除失败！", opts);
      return;
    }
    else {
      var obj_del = new Array();
      var processResult_del = function () {
        toastr.success("删除完成", "删除成功！", opts);
        $('#deleteModal').modal('hide');
        setTimeout(function()
        {
          loadFromWS("Home/person/loadPersons.template", "id=-1"+"$^@^$loginName="+sessionStorage.getItem("loginName")+"$^@^$disable=able", "wholetable");
        }, 1000);
      }
      var postdata = "id=" + id +"$^@^$classification=" + classification;
      getFromWS("Home/person/delPerson.template", postdata, obj_del, processResult_del);
    }
  })
</script>
<!-- Bottom Scripts -->
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/TweenMax.min.js"></script>
<script src="/assets/js/resizeable.js"></script>
<script src="/assets/js/joinable.js"></script>
<script src="/assets/js/xenon-api.js"></script>
<script src="/assets/js/xenon-toggles.js"></script>
<script src="/assets/js/datatables/js/jquery.dataTables.min.js"></script>
<!-- Imported scripts on this page -->
<script src="/assets/js/toastr/toastr.min.js"></script>
<script src="/assets/js/uikit/js/uikit.min.js"></script>
<script src="/assets/js/bootstrap-treeview.min.js"></script>
<script src="/assets/js/datatables/dataTables.bootstrap.js"></script>
<script src="/assets/js/datatables/yadcf/jquery.dataTables.yadcf.js"></script>
<script src="/assets/js/datatables/tabletools/dataTables.tableTools.min.js"></script>
<script src="/assets/js/select2/select2.min.js"></script>
<script src="/assets/js/jquery-ui/jquery-ui.min.js"></script>
<script src="/assets/js/selectboxit/jquery.selectBoxIt.min.js"></script>
<script src="/assets/js/multiselect/js/jquery.multi-select.js"></script>
<link rel="stylesheet" href="/assets/js/select2/select2.css">
<link rel="stylesheet" href="/assets/js/select2/select2-bootstrap.css">
<script src="/assets/js/select2/select2.min.js"></script>

</body>
</html>
